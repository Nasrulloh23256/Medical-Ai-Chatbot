import{v as b,r as v,j as e,$ as C,a as w,m as E}from"./app-DCzU8fPO.js";import{L as d,I as l}from"./label-CeYDUFqG.js";import{T as y}from"./text-link-CFSrhyvS.js";import{B as I}from"./app-logo-icon-DHm6msfP.js";import{I as m}from"./index-AVa3EdGz.js";import{A as N,L as _}from"./auth-layout-Brspj5Rf.js";/* empty css            */import"./theme-switcher-o2pzdSWf.js";function R(){const{data:a,setData:o,errors:i,setError:c,clearErrors:f}=b({name:"",email:"",password:"",password_confirmation:""}),[r,u]=v.useState(!1),j=async s=>{var x,h,g;s.preventDefault(),u(!0),f();try{const t=(await w.post("/api/register",{name:a.name,email:a.email,password:a.password,password_confirmation:a.password_confirmation})).data.access_token;if(!t)throw new Error("Token tidak diterima dari server setelah registrasi.");localStorage.setItem("access_token",t),w.defaults.headers.common.Authorization=`Bearer ${t}`,E.post(route("login"),{email:a.email,password:a.password},{onError:p=>{c("email","Gagal membuat sesi setelah registrasi berhasil.")}})}catch(n){if(((x=n.response)==null?void 0:x.status)===422&&((g=(h=n.response)==null?void 0:h.data)!=null&&g.errors)){const t=n.response.data.errors;Object.keys(t).forEach(p=>{c(p,t[p][0])})}else c("email","Terjadi kesalahan saat mendaftar.");u(!1)}};return e.jsxs(N,{title:"Create an account",description:"Enter your details below to create your account",children:[e.jsx(C,{title:"Register"}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:j,children:[e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"name",children:"Name"}),e.jsx(m,{id:"name",type:"text",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"name",value:a.name,onChange:s=>o("name",s.target.value),disabled:r,placeholder:"Full name"}),e.jsx(l,{message:i.name,className:"mt-2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"email",children:"Email address"}),e.jsx(m,{id:"email",type:"email",required:!0,tabIndex:2,autoComplete:"email",value:a.email,onChange:s=>o("email",s.target.value),disabled:r,placeholder:"email@example.com"}),e.jsx(l,{message:i.email})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"password",children:"Password"}),e.jsx(m,{id:"password",type:"password",required:!0,tabIndex:3,autoComplete:"new-password",value:a.password,onChange:s=>o("password",s.target.value),disabled:r,placeholder:"Password"}),e.jsx(l,{message:i.password})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"password_confirmation",children:"Confirm password"}),e.jsx(m,{id:"password_confirmation",type:"password",required:!0,tabIndex:4,autoComplete:"new-password",value:a.password_confirmation,onChange:s=>o("password_confirmation",s.target.value),disabled:r,placeholder:"Confirm password"}),e.jsx(l,{message:i.password_confirmation})]}),e.jsxs(I,{type:"submit",className:"mt-2 w-full",tabIndex:5,disabled:r,children:[r&&e.jsx(_,{className:"h-4 w-4 animate-spin"}),"Create account"]})]}),e.jsxs("div",{className:"text-muted-foreground text-center text-sm",children:["Already have an account?"," ",e.jsx(y,{href:route("login"),tabIndex:6,children:"Log in"})]})]})]})}export{R as default};
